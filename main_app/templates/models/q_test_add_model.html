{% load static %}

<div class="model" id="model-{{ student.id }}-id-{{type}}">
    <div class="model-header">
        <div class="title-model">{{key}} : {{student.name}}</div>
        <button data-close-button class="close-btn">&times;</button>
    </div>
    <div class="model-body">
        <link rel="stylesheet" href="{% static 'css/add_q_test_style.css' %}">
        <div class="main-add-q-test container">
            <form action="{% url 'add_q_test' %}" method="POST">
                {% csrf_token %}
                <input type="hidden" name="student-id" value="{{ student.id }}">
                <div id="filter-test-type-radio-{{ student.id }}" class="d-flex flex-column gap-3 mb-3 rounded p-3 text-white" style="background-color: #50109b; border: 2px solid white"> 
                    <div>
                        <input type="radio" name="q-test-type-filter" id="id-q-test-type-filter-one-{{ student.id }}" value="normal-test" checked>
                        <label for="id-q-test-type-filter-one-{{ student.id }}">سبر عادي</label>
                    </div>
                    <div>
                        <input type="radio" name="q-test-type-filter" id="id-q-test-type-filter-two-{{ student.id }}" value="candidate-test">
                        <label for="id-q-test-type-filter-two-{{ student.id }}">سبر ترشيحي</label>
                    </div>
                </div>
                <section id="first-section-form-q-test-{{ student.id }}">
                    <h4 class="text-white title w-100 mt-5">سبر عادي</h4>
                    <div id="filter-add-q-test-radio" class="d-flex flex-column gap-3 mb-3 rounded p-3 text-white" style="background-color: #001845; border: 1px solid rgba(255, 255, 255, 0.8)"> 
                        <div>
                            <input type="radio" name="add-q-test-filter" id="name-add-q-test-filter-one-{{ student.id }}" value="qurater-part" checked>
                            <label for="name-add-q-test-filter-one-{{ student.id }}">ربع حزب</label>
                        </div>
                        <div>
                            <input type="radio" name="add-q-test-filter" id="name-add-q-test-filter-two-{{ student.id }}" value="half-part">
                            <label for="name-add-q-test-filter-two-{{ student.id }}">نصف حزب</label>
                        </div>
                        <div>
                            <input type="radio" name="add-q-test-filter" id="name-add-q-test-filter-three-{{ student.id }}" value="whole-part">
                            <label for="name-add-q-test-filter-three-{{ student.id }}">حزب</label>
                        </div>
                    </div>
                    <input name="q-part-number" placeholder="أدخل رقم الحزب" class="form-control" type="number" min="1" max="60" required>
                    <div class="d-flex flex-column rounded p-3 my-3" style="background-color: white; border: 2px solid var(--clr1);">
                        <h5 class="text-center mt-1 mb-4">ربع الحزب</h5>
                        <div class="d-flex justify-content-center flex-wrap align-items-center gap-2">
                            <input type="radio" class="btn-check" name="quarter-q-part-number" id="first-quarter-q-part-{{ student.id }}" autocomplete="off" value="first-quarter" checked>
                            <label class="btn btn-outline-primary" for="first-quarter-q-part-{{ student.id }}">الربع الأول</label>
                            <input type="radio" class="btn-check" name="quarter-q-part-number" id="second-quarter-q-part-{{ student.id }}" autocomplete="off" value="second-quarter">
                            <label class="btn btn-outline-primary" for="second-quarter-q-part-{{ student.id }}">الربع الثاني</label>
                            <input type="radio" class="btn-check" name="quarter-q-part-number" id="third-quarter-q-part-{{ student.id }}" autocomplete="off" value="third-quarter">
                            <label class="btn btn-outline-primary" for="third-quarter-q-part-{{ student.id }}">الربع الثالث</label>
                            <input type="radio" class="btn-check" name="quarter-q-part-number" id="fourth-quarter-q-part-{{ student.id }}" autocomplete="off" value="fourth-quarter">
                            <label class="btn btn-outline-primary" for="fourth-quarter-q-part-{{ student.id }}">الربع الرابع</label>
                        </div>
                    </div>
                    <div class="d-flex flex-column rounded p-3 my-3 d-none" style="background-color: white; border: 2px solid var(--clr1);">
                        <h5 class="text-center mt-1 mb-4">نصف الحزب</h5>
                        <div class="d-flex justify-content-center flex-wrap align-items-center gap-2">
                            <input type="radio" class="btn-check" name="half-q-part-number" id="first-half-q-part-{{ student.id }}" autocomplete="off" value="first-half" checked>
                            <label class="btn btn-outline-primary" for="first-half-q-part-{{ student.id }}">النصف الأول</label>
                            <input type="radio" class="btn-check" name="half-q-part-number" id="second-half-q-part-{{ student.id }}" autocomplete="off" value="second-half">
                            <label class="btn btn-outline-primary" for="second-half-q-part-{{ student.id }}">النصف الثاني</label>
                        </div>
                    </div>
                </section>
                <section id="second-section-form-q-test-{{ student.id }}" class="d-none">
                    <h4 class="text-white title w-100 mt-5">سبر ترشيحي</h4>
                    <input name="q-section-candidate-number" placeholder="أدخل رقم الجزء" class="form-control" type="number" min="1" max="30">
                </section>
                <button class="btn btn-success mt-3 w-100" type="submit">إضافة</button>
            </form>
        </div>
    </div>
</div>

<script>
    let filterTypeOneId{{student.id}} = document.getElementById("id-q-test-type-filter-one-{{ student.id }}")
    let filterTypeTwoId{{student.id}} = document.getElementById("id-q-test-type-filter-two-{{ student.id }}")
    let firstSectionFormTest{{student.id}} = document.getElementById("first-section-form-q-test-{{ student.id }}")
    let secondSectionFormTest{{student.id}} = document.getElementById("second-section-form-q-test-{{ student.id }}")

    filterTypeOneId{{student.id}}.onclick = function(){
        secondSectionFormTest{{student.id}}.classList.add("d-none")
        firstSectionFormTest{{student.id}}.classList.remove("d-none")
        secondSectionFormTest{{student.id}}.children[1].required = false
        firstSectionFormTest{{student.id}}.children[2].required = true
        firstSectionFormTest{{student.id}}.closest(".main-add-q-test").classList.remove("extra-padding")
    }
    
    filterTypeTwoId{{student.id}}.onclick = function(){
        firstSectionFormTest{{student.id}}.classList.add("d-none")
        secondSectionFormTest{{student.id}}.classList.remove("d-none")
        secondSectionFormTest{{student.id}}.children[1].required = true
        firstSectionFormTest{{student.id}}.children[2].required = false
        firstSectionFormTest{{student.id}}.closest(".main-add-q-test").classList.add("extra-padding")
    }


    let firstTypeOfNormalQTest{{student.id}} = document.getElementById("name-add-q-test-filter-one-{{ student.id }}")
    let secondTypeOfNormalQTest{{student.id}} = document.getElementById("name-add-q-test-filter-two-{{ student.id }}")
    let thirdTypeOfNormalQTest{{student.id}} = document.getElementById("name-add-q-test-filter-three-{{ student.id }}")

    firstTypeOfNormalQTest{{student.id}}.onclick = function(){
        firstSectionFormTest{{student.id}}.children[3].classList.remove("d-none")
        firstSectionFormTest{{student.id}}.children[4].classList.add("d-none")
    }

    secondTypeOfNormalQTest{{student.id}}.onclick = function(){
        firstSectionFormTest{{student.id}}.children[3].classList.add("d-none")
        firstSectionFormTest{{student.id}}.children[4].classList.remove("d-none")
    }

    thirdTypeOfNormalQTest{{student.id}}.onclick = function(){
        firstSectionFormTest{{student.id}}.children[3].classList.add("d-none")
        firstSectionFormTest{{student.id}}.children[4].classList.add("d-none")
    }

</script>